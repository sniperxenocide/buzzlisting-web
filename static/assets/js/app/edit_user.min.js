"use strict";var old_image;$.ajax({type:"GET",url:edit_user_url,success:function(e){null==e.expiry_date?$("#date_box").val(null):$("#date_box").val(moment(e.expiry_date).format("YYYY-MM-DD HH:mm"));var a=e.role;e.replaced_by;$("#status").selectpicker("refresh"),$("#status").selectpicker("val",[e.status]),$.ajax({type:"GET",url:all_role,dataType:"json",success:function(e){$.each(e,function(e,a){$("#role_select").append($("<option>",{value:a.id,text:a.name}))}),$("#role_select").selectpicker("refresh"),$("#role_select").selectpicker("val",[a])}}),old_image=e.avatar,old_image&&$(".fileinput-preview").append('<img src="'+old_image+'" class="img-responsive m-t-0">'),$("#first_name").val(e.first_name),$("#last_name").val(e.last_name),$("#username").val(e.username),$("#email").val(e.email),$("#address").val(e.address),$("#replaced_by").val(e.replaced_by),$("#replaced_by_font").val(e.replaced_by_username),$("#phone_number").val(e.phone_number),$("#position").val(e.position)},error:function(e){}}),$("#date_box").datetimepicker({format:"YYYY-MM-DD hh:mm",useCurrent:!1,minDate:moment()});var app=app||{};!function(e,a){a.utils={},a.utils.formDataSuppoerted=function(){return!!("FormData"in window)}()}(jQuery,app),function(e,a){window.Parsley.addValidator("filemaxmegabytes",{requirementType:"string",validateString:function(e,t,r){if(!a.utils.formDataSuppoerted)return!0;var n=r.$element[0].files,s=1048576*t;return 0==n.length||1===n.length&&n[0].size<=s},messages:{en:"File is to big"}}).addValidator("filemimetypes",{requirementType:"string",validateString:function(e,t,r){if(!a.utils.formDataSuppoerted)return!0;var n=r.$element[0].files;if(0==n.length)return!0;var s=t.replace(/\s/g,"").split(",");return s.indexOf(n[0].type)!==-1},messages:{en:"File mime type not allowed"}})}(jQuery,app),function(e,a){e("#create_user").parsley()}(jQuery,app);var frm=$("#create_user");frm.submit(function(e){e.preventDefault();var a=new FormData($(this)[0]);return""==$(this).serializeArray()[12].value&&a.delete("password"),""==$("#avatar").val()&&$(".fileinput-preview").children().length>0?a.delete("avatar"):$(".fileinput-preview").children().length<1&&a.set("avatar",""),$.ajax({type:"PATCH",url:edit_user_patch,data:a,processData:!1,contentType:!1,success:function(e){notify("Congratulations!!! "," User information updated Successfully ","","success"),setTimeout(function(){window.location=user_management_page},1200)},error:function(e){var a=e.responseText;$.each(JSON.parse(a),function(e,a){var t=e+": "+a;notify("",t,"","danger")})}}),!1}),$("#go_back").on("click",function(e){e.preventDefault(),window.location=user_management_page}),$("#password").on("keydown",function(){$("#cfrm_password").val("").parsley().reset()}),$("#password").on("keyup",function(){""!=$("#password").val()?$("#cfrm_password").attr("data-parsley-required","true"):$("#cfrm_password").removeAttr("data-parsley-required")});