"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _stringify=require("babel-runtime/core-js/json/stringify"),_stringify2=_interopRequireDefault(_stringify),table;!function(){$("#group_list").DataTable({processing:!0,serverSide:!0,ajax:$.fn.dataTable.pipeline({url:all_group_api,pages:1}),scrollY:300,deferRender:!0,scroller:!0,columns:[{title:"Name",data:"name"},{title:"Status",data:"status"},{title:"Assigned User Number",data:"user"}],columnDefs:[{targets:0,width:"30%"},{targets:1,width:"30%",render:function(e){return 1==e?"Active":"Inactive"}},{targets:2,width:"30%",render:function(e,t,r){return r.user.length}}]}),table=$("#group_list").DataTable(),$("#group_list tbody").on("click","tr",function(){var e=table.row(this).data(),t=$("#edit_group_button"),r=$("#delete_group_button");$(this).hasClass("selected")?($(this).removeClass("selected"),r.removeData("group-id").removeClass("c-black"),t.removeData("group-id").removeClass("c-black")):(table.$("tr.selected").removeClass("selected"),$(this).addClass("selected"),r.removeData("group-id").data("group-id",e.id),r.addClass("c-black"),r.attr({"data-toggle":"modal","data-target":""}),t.removeData("group-id").data("group-id",e.id).addClass("c-black"),t.attr({"data-toggle":"modal","data-target":""}))}),$(document).on("click","#add_group_button",function(){$.ajax({type:"GET",url:all_user_api,dataType:"json",success:function(e){$.each(e,function(e,t){$("#user_select").append($("<option>",{value:t.id,text:t.first_name+" "+t.last_name+" ("+t.username+")"}))}),$("#user_select").selectpicker("refresh")},error:function(e){$.each(JSON.parse(e.responseText),function(e,t){notify("<strong>"+(e.substr(0,1).toUpperCase()+e.substr(1))+":</strong> ","<i>"+t+"</i>","","danger",1e4)})}}),$("#add_group_modal").modal().show()}),$("#save_group").on("click",function(e){e.preventDefault();var t=$("#add_group_form").parsley();if(t.validate(),t.isValid()){$("#group_list").DataTable();$.ajax({url:add_group_api,method:"POST",data:$("#add_group_form").serialize(),success:function(e){$("#add_group_form").trigger("reset"),$("#add_group_modal").modal("toggle")},error:function(e){$.each(JSON.parse(e.responseText),function(e,t){notify("<strong>"+(e.substr(0,1).toUpperCase()+e.substr(1))+":</strong> ","<i>"+t+"</i>","","danger",1e4)})}})}}),$(document).on("click","#delete_group_button",function(){var e=$(this).data("group-id"),t=$("#group_list").find(".selected");if($(this).data("group-id")){var r="/api/v1/group/"+e;e="",swal({title:"Are you sure?",text:"You will not be able to recover this Group Information!",type:"warning",showCancelButton:!0,confirmButtonText:"Delete",cancelButtonText:"Cancel"}).then(function(e){return!!e&&void $.ajax({type:"DELETE",url:r,processData:!1,contentType:!1,success:function(e){t.remove().draw(),notify("Congratulations!!! ","Group has been Deleted Successfully","","success")},error:function(e){var t=e.responseText;$.each(JSON.parse(t),function(e,t){var r=e.toUpperCase()+": "+t;notify("",r,"","danger",5e3)})}})})}else notify("No Group selected!!! ","Please select a Group first","","danger")}),$(document).on("click","#edit_group_button",function(){if($(this).data("group-id")){var e,t=$(this).data("group-id"),r="/api/v1/group/"+t;$.ajax({type:"GET",url:r,success:function(t){e=t.user,$("#name").val(t.name),$("#status").selectpicker("refresh"),$("#status").selectpicker("val",[t.status]),$.ajax({type:"GET",url:all_user_api,dataType:"json",success:function(t){$.each(t,function(e,t){$("#user_edit_select").append($("<option>",{value:t.id,text:t.first_name+" "+t.last_name+" ("+t.username+")"}))}),$("#user_edit_select").selectpicker("refresh"),$("#user_edit_select").selectpicker("val",e)},error:function(e){$.each(JSON.parse(errors),function(e,t){var r=e+": "+t;notify("",r,"","danger")})}})},error:function(e){$.each(JSON.parse(e.responseText),function(e,t){notify("<strong>"+(e.substr(0,1).toUpperCase()+e.substr(1))+":</strong> ","<i>"+t+"</i>","","danger",1e4)})}}),$("#edit_group_modal").modal().show()}else notify("No Group selected!!! ","Please select a Group first","","danger",5e3)});var e=$("#update_group_form").parsley();$("#update_group").on("click",function(t){if(t.preventDefault(),e.validate(),e.isValid()){var r=$("#edit_group_button").data("group-id"),a="/api/v1/group/"+r+"/",o={name:$("#name").val(),status:$("#status").val(),user:null!=$("#user_edit_select").val()?$("#user_edit_select").val():[]};$.ajax({url:a,method:"PATCH",data:(0,_stringify2.default)(o),processData:!1,headers:{"content-type":"application/json"},success:function(e){$("#update_group_form").trigger("reset"),$("#edit_group_modal").modal("toggle"),notify("Congratulations!!! ","Information has been Updated Successfully","","success")},error:function(e){$.each(JSON.parse(e.responseText),function(e,t){notify("<strong>"+(e.substr(0,1).toUpperCase()+e.substr(1))+":</strong> ","<i>"+t+"</i>","","danger",1e4)})}})}}),$("#add_group_modal").on("hidden.bs.modal",function(){$("#add_group_form").trigger("reset"),$(".help-block").empty(),$(".form-group").removeClass("has-error"),$(".fg-line").removeClass("fg-toggled"),$("#user_select option[value]").remove(),$("#status").hide()}),$("#edit_group_modal").on("hidden.bs.modal",function(){$("#update_group_form").trigger("reset"),$(".help-block").empty(),$(".form-group").removeClass("has-error"),$(".fg-line").removeClass("fg-toggled"),$("#user_edit_select option[value]").remove()}),$("#user_list_modal").on("hidden.bs.modal",function(){$("#user_list").empty()}),$(document).on("click",".paginate_button",function(){$("#group_list").find(".selected").length>0&&($("#edit_group_button").removeData("group-id").removeClass("c-black"),$("#delete_group_button").removeData("group-id").removeClass("c-black"),$("#group_list tbody tr").removeClass("selected"))}),$("#group_list tbody").on("dblclick","tr",function(){var e=table.row(this).data(),t=e.id,r="/api/v1/group/"+t;$.ajax({type:"GET",url:r,success:function(e){e.user_detail.length>0?$.each(e.user_detail,function(e,t){$("#user_list").append("<li>"+t+"</li>")}):$("#user_list").append("<p>Sorry!!! No User Assigned yet</p>"),$("#user_list_modal").modal().show()},error:function(e){$.each(JSON.parse(e.responseText),function(e,t){notify("<strong>"+(e.substr(0,1).toUpperCase()+e.substr(1))+":</strong> ","<i>"+t+"</i>","","danger",1e4)})}})})}();