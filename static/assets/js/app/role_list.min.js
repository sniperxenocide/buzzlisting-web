"use strict";var table;!function(){$("#role_list").DataTable({processing:!0,serverSide:!0,ajax:$.fn.dataTable.pipeline({url:all_role,pages:1}),scrollY:300,deferRender:!0,scroller:!0,columns:[{title:"Name",data:"name"},{title:"Code",data:"code"},{title:"Status",data:"active"}],columnDefs:[{targets:0,width:"30%"},{targets:1,width:"30%"},{targets:2,width:"30%",render:function(e){return 1==e?"Active":"Inactive"}}]}),table=$("#role_list").DataTable(),$("#role_list tbody").on("click","tr",function(){var e=table.row(this).data(),t=$("#edit_role_button"),o=$("#delete_role_button");$(this).hasClass("selected")?($(this).removeClass("selected"),o.removeData("role-id").removeClass("c-black"),t.removeData("role-id").removeClass("c-black")):(table.$("tr.selected").removeClass("selected"),$(this).addClass("selected"),o.removeData("role-id").data("role-id",e.id),t.removeData("role-id").data("role-id",e.id),1==o.data("role-id")?o.removeClass("c-black"):o.addClass("c-black"),1==t.data("role-id")?t.removeClass("c-black"):t.addClass("c-black"),o.attr({"data-toggle":"modal","data-target":""}),t.attr({"data-toggle":"modal","data-target":""}))}),$(document).on("click","#add_role_button",function(){$.ajax({type:"GET",url:all_permissions_api,dataType:"json",success:function(e){$.each(e,function(e,t){$("#permission_select").append($("<option>",{value:t.id,text:t.name}))}),$("#permission_select").selectpicker("refresh")},error:function(e){console.log(e)}}),$("#add_role_modal").modal().show()}),$("#save_role").on("click",function(e){e.preventDefault();var t=$("#add_role_form").parsley();if(t.validate(),t.isValid()){$("#role_list").DataTable();$.ajax({url:add_role_api,method:"POST",data:$("#add_role_form").serialize(),success:function(e){$("#add_role_form").trigger("reset"),$("#add_role_modal").modal("toggle")},error:function(e){$.each(JSON.parse(e.responseText),function(e,t){notify("<strong>"+(e.substr(0,1).toUpperCase()+e.substr(1))+":</strong> ","<i>"+t+"</i>","","danger",1e4)})}})}}),$(document).on("click","#delete_role_button",function(){var e=$(this).data("role-id"),t=$("#role_list").find(".selected");if($(this).data("role-id"))if(1===e)notify("Sorry!!! ","System can not delete Workflow Admin!!!","","danger");else{var o="/api/v1/role/"+e;e="",swal({title:"Are you sure?",text:"You will not be able to recover this Role Information!",type:"warning",showCancelButton:!0,confirmButtonText:"Delete",cancelButtonText:"Cancel"}).then(function(e){return!!e&&void $.ajax({type:"DELETE",url:o,processData:!1,contentType:!1,success:function(e){t.remove().draw(),notify("Congratulations!!! ","Role has been Deleted Successfully","","success")},error:function(e){var t=e.responseText;$.each(JSON.parse(t),function(e,t){var o=e.toUpperCase()+": "+t;notify("",o,"","danger",5e3)})}})})}else notify("No Role selected!!! ","Please select a Role first","","danger")}),$(document).on("click","#edit_role_button",function(){if($(this).data("role-id")){var e=$(this).data("role-id");if(1==e)notify("Sorry!!! ","You can not edit this role!!!","","danger",5e3);else{var t,o="/api/v1/role/"+e;$.ajax({type:"GET",url:o,success:function(e){t=e.permission,$("#name").val(e.name),$("#code").val(e.code),$("#active").selectpicker("refresh"),$("#active").selectpicker("val",[e.active]),$.ajax({type:"GET",url:all_permissions_api,dataType:"json",success:function(e){$.each(e,function(e,t){$("#permission_edit_select").append($("<option>",{value:t.id,text:t.name}))}),$("#permission_edit_select").selectpicker("refresh"),$("#permission_edit_select").selectpicker("val",t)},error:function(e){console.log(e)}})},error:function(e){}}),$("#edit_role_modal").modal().show()}}else notify("No Role selected!!! ","Please select a Role first","","danger",5e3)});var e=$("#update_role_form").parsley();$("#update_role").on("click",function(t){if(t.preventDefault(),e.validate(),e.isValid()){var o=$("#edit_role_button").data("role-id"),a="/api/v1/role/"+o+"/";$.ajax({url:a,method:"PATCH",data:$("#update_role_form").serialize(),success:function(e){$("#update_role_form").trigger("reset"),$("#edit_role_modal").modal("toggle"),notify("Congratulations!!! ","Information has been Updated Successfully","","success")},error:function(e){$.each(JSON.parse(e.responseText),function(e,t){notify("<strong>"+(e.substr(0,1).toUpperCase()+e.substr(1))+":</strong> ","<i>"+t+"</i>","","danger",1e4)})}})}}),$("#add_role_modal").on("hidden.bs.modal",function(){$("#add_role_form").trigger("reset"),$(".help-block").empty(),$(".form-group").removeClass("has-error"),$(".fg-line").removeClass("fg-toggled"),$("#permission_select option[value]").remove()}),$("#edit_role_modal").on("hidden.bs.modal",function(){$("#update_role_form").trigger("reset"),$(".help-block").empty(),$(".form-group").removeClass("has-error"),$(".fg-line").removeClass("fg-toggled"),$("#permission_edit_select option[value]").remove()}),$("#permissions_list_modal").on("hidden.bs.modal",function(){$("#permission_list").empty()}),$(document).on("click",".paginate_button",function(){$("#role_list").find(".selected").length>0&&($("#edit_role_button").removeData("role-id").removeClass("c-black"),$("#delete_role_button").removeData("role-id").removeClass("c-black"),$("#role_list tbody tr").removeClass("selected"))}),$("#role_list tbody").on("dblclick","tr",function(){var e=table.row(this).data(),t=e.id,o="/api/v1/role/"+t;$.ajax({type:"GET",url:o,success:function(e){$.each(e.permission_name,function(e,t){$("#permission_list").append('<li class="c-black">'+t+"</li>")}),$("#permissions_list_modal").modal().show()},error:function(e){console.log(e)}})})}();